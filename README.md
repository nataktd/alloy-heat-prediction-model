# Прогноз температуры стали во время плавки
# Описание проекта
Металлургический комбинат ООО «Так закаляем сталь» решил провести проект с целью оптимизации производственных расходов.
Одним из основных направлений оптимизации является уменьшение потребления электроэнергии на этапе обработки стали.
Для достижения этой цели, необходимо построить математическую модель, которая способна предсказывать температуру стали в процессе обработки.

# Цель:
Целью проекта является уменьшение потребления электроэнергии на этапе обработки стали на металлургическом комбинате ООО «Так закаляем сталь».
Для достижения этой цели необходимо разработать и использовать модель, которая будет способна предсказывать температуру стали в ходе её обработки.

# Технологический процесс
Технологический процесс обработки стали на металлургическом комбинате ООО "Так закаляем сталь" включает в себя несколько этапов.

Ниже представлено подробное описание каждого этапа:

Подготовка и начальная обработка:
- Сырье, представленное в виде металлических заготовок, поступает на металлургический комбинат.
- Заготовки загружаются в металлический ковш вместимостью около 100 тонн.
- Внутренние стенки ковша облицовываются огнеупорным кирпичом для выдерживания высоких температур.

Плавка стали:
- Расплавленная сталь заливается в ковш.
- Для нагрева стали до нужной температуры используют графитовые электроды, установленные в крышке ковша.

Обработка сплава:
- Из сплава выводится сера в процессе десульфурации.
- Коррекция химического состава сплава выполняется добавлением примесей.
- Проводится отбор проб для дальнейшего анализа.
- Сталь легируется, что означает изменение её химического состава. Легирующие материалы могут подаваться в виде кусков сплава из бункера для сыпучих материалов или проволоки через специальный трайб-аппарат.

Контроль температуры и химического состава:
- Перед введением легирующих добавок измеряется температура стали и проводится химический анализ.
- Температуру повышают на несколько минут, добавляют легирующие материалы и продувают сплав инертным газом.
- Сплав перемешивается, и снова проводятся измерения.
- Этот цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.

Завершение обработки:
- После достижения целевого химического состава и температуры плавки, расплавленная сталь направляется на доводку металла или поступает в машину непрерывной разливки.
- В результате завершения процесса обработки, готовый продукт выходит в виде заготовок-слябов (плит).
- Этот технологический процесс имеет ключевое значение для получения качественной стали, и его оптимизация может значительно влиять на производственные расходы и эффективность комбината.

# Описание данных
Для выполнения проекта доступны данные из разных источников.

Данные представлены в следующих файлах:
- data_arc_new.csv: Этот файл содержит данные об использовании электродов.
- data_bulk_new.csv: В данном файле содержится информация о подаче сыпучих материалов (объём).
- data_bulk_time_new.csv: В этом файле содержатся данные о подаче сыпучих материалов (время).
- data_gas_new.csv: Данный файл содержит информацию о продувке сплава газом.
- data_temp_new.csv: В этом файле хранятся результаты измерения температуры.
- data_wire_new.csv: Данный файл содержит информацию о проволочных материалах (объём).
- data_wire_time_new.csv: В этом файле хранятся данные о проволочных материалах (время).

В каждом из файлов столбец с названием key содержит номер партии, и в файлах могут быть несколько строк с одинаковым значением key, что соответствует разным итерациям обработки стали.

# План работы:
- 1  Изучение данных и подготовка к работе
    - 1.1  Переменные константы и функции
    - 1.2  Общая информация о датасетах и данных
        - 1.2.1  Данные об электродах
        - 1.2.2  Данные о подаче сыпучих материалов (объём)
        - 1.2.3  Данные о подаче сыпучих материалов (время)
        - 1.2.4  Данные о проволочных материалах (объём)
        - 1.2.5  Данные о проволочных материалах (время)
        - 1.2.6  Данные о продувке сплава газом
        - 1.2.7  Результаты измерения температуры
        - 1.2.8  Исследование данных внутри отдельной партии
        - 1.2.9  Выводы по предварительному анализу данных
    - 1.3  Предложения по дальнейшей обработке данных
- 2  Преодобработка данных
    - 2.1  Обработка данных датафреймов df_bulk и df_wire
    - 2.2  Обработка данных датафрейма df_arc
    - 2.3  Обработка данных датафрейма df_temp
    - 2.4  Объединение таблиц
- 3  Обучение алгоритмов
    - 3.1  Подготовка выборок
    - 3.2  Обучение алгоритмов.Кросс-валидация и пайплайн.
    - 3.3  Дополнительный датасет
    - 3.4  Анализ результатов предсказания (п. 3.2.)
    - 3.5  Проверка лучшей модели на тестовой выборке
    - 3.6  Проверка лучшей модели на адекватность
    - 3.7  Доработка модели
        - 3.7.1  Розбор проблематики масштабирования и полученных результатов.
- 4  Итоги выводы по проекту

# Использованные библиотеки в проекте:
Стандартные библиотеки:
- `os` - работа с операционной системой.
- `time` - работа со временем.

Библиотеки для обработки данных:
- `pandas` - обработка и анализ данных.
- `numpy` - вычислительные операции над массивами.

Визуализация данных:
- `matplotlib.pyplot` - визуализация данных в виде графиков.
- `seaborn` - улучшенная визуализация данных.
- `plotly.express` - создание интерактивных графиков.

Модели машинного обучения:
- `train_test_split` - разделение данных на обучающую и тестовую выборки.
- `GridSearchCV` - поиск оптимальных параметров модели.

Модели регрессии:
- `LinearRegression` - линейная регрессия.
- `LGBMRegressor` - градиентный бустинг с использованием LightGBM.
- `RandomForestRegressor` - случайный лес.
- `XGBRegressor` - градиентный бустинг с использованием XGBoost.
- `DecisionTreeRegressor` - дерево решений.
- `Ridge` - регрессия с использованием регуляризации.
- `CatBoostRegressor` - градиентный бустинг с использованием CatBoost.
- `DummyRegressor` - простая базовая модель для сравнения.

Метрика качества:
- `mean_absolute_error` - средняя абсолютная ошибка.

Преобразование данных:
- `StandardScaler` - стандартизация данных.
- `Pipeline` из библиотеки `imblearn` - построение конвейера преобразования данных.

#  Итоговая модель, гипперпараметры и качество

Лучшей моделью после проведения ĸросс-валидации стала `CatBoostRegressor`, на тестовой выборĸе удалось получить следующее значение метриĸи при выбранных гиперпараметраx:

- `MAE` - 5.91

- `depth` - 6 `learning_rate` - 0.04 `n_estimators` - 700 `random_state` - 61023